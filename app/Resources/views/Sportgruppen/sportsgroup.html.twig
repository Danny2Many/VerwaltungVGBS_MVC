{% extends "basic.html.twig" %}
{% form_theme searchform 'bootstrap_3_layout.html.twig' %}

{% block viewlink %}{{ path('sportsgroup_home') }}{% endblock %}
{% block title %} Sportgruppen {% endblock %}
{% block viewname %}Sportgruppen{% endblock %}
{% block SportgrAktiv %} active {% endblock %}
{% block NmemSportgrAktiv %} active {% endblock %}
{% block fixedcolnum %} 6 {% endblock %}
{% block columnDefs %}
            "columnDefs": [
            { "width": "1%", "targets": 0 },
            { "width": "2%", "targets": 1 },
            { "width": "3%", "targets": 2 },
            { "width": "10%", "targets": 3 },
            { "width": "15%", "targets": 4 },
            { "width": "10%", "targets": 5 },
            {"width" : "6%", "targets": 16},
            {"width" : "5%", "targets": 14},
        ]
{% endblock%} 

{% block add %}
    <a href="{{ path('addsportsgroup', {'letter': cletter }) }}"><button    class="add btn btn-default">
      <span class="glyphicon glyphicon-plus"></span> neue Sportgruppe anlegen
        </button></a>  
{% endblock %}

{% block color %} {{ colorclass }} {% endblock %}

{% block thead %}
    <th>Bearb.</th>
    <th>Sportgruppe</th>
    <th>Info</th>
    <th>Uhrzeit</th>
    <th>Räumlichkeit</th>
    <th>Gruppenbezeichnung</th>
    <th>Voranmeldungen</th>
    <th>Übungsleiter</th>
    <th>Vetretungsmöglichkeit</th>
    <th><span style="color:black ;">Mitglieder-<br></span>gesamt</th>
    <th><span style="color:black ;">Kurs-TN<br></span>weiblich</th>
    <th>männlich</th>
    <th><span style="color:black;">Kapazität<br></span>gesamt</th>
    <th>offen</th>
    <th><span style="color:black;">BSSA-<br></span>Laufzeit bis</th>
    <th><span style="color:black;">Zertifizierung<br></span>Erstanmeldung</th>
    <th>Letzte Änderung</th>
    <th>VGBS-GruppenNr.</th>
    <th>BSSA-Zertifikatnr.</th>
    <th><span style="color:black;">Finanzen<br></span>Einnahmen gesamt/Monat</th>
    <th>Anzahl RS</th>
    <th>ÜL-Kosten + Halle</th>
    <th>Saldo</th>
{% endblock %}
 
{% block tbody %}
    {% for data in tabledata %}
        
        <tr>
        <td><a href="{{ path('editsportsgroup', {'letter': data.day, 'ID': data.sgid}) }}">
                <button  class='btn btn-default btn-sm'  name='update'> <span class='glyphicon glyphicon-wrench'></span></button></a>
                {#<a href="{{ path('editmemsportsgroup', {'letter': data.day, 'ID': data.sgid }) }}"><button  class='btn btn-default btn-sm'  name='intern'> <span class='glyphicon glyphicon-folder-open'></span></button></a></td>       #}
        <td>{{ data.name|striptags }}</td>
        <td>{{ data.info|striptags }}</td> 
        <td>{{ data.time|date("H:i") }}</td>
        {% if sportsgroupdependentlist[data.room.roomid]['room'] is defined %}
        {% set room =sportsgroupdependentlist[data.room.roomid]['room'] %}
        {% else %}
          {% set room  ='' %}  
        {% endif %}
        <td>{% for RO in room %}                     
               {{RO.roomname }}
            {% else %}
                {{ "-" }}</td>
            {% endfor %}
        <td>{{ data.token|striptags }}</td>
        <td>{{ "-" }}</td>
        {% if sportsgroupdependentlist[data.trainerid]['trainers'] is defined %}
            {% set trainer =sportsgroupdependentlist[data.trainerid]['trainers'] %}
        {% else %}
          {% set trainer ='' %}  
        {% endif %}
        <td>{% for TR in trainer %}                     
               {{TR.firstname }} {{TR.lastname}}<br>
            {% else %}
                {{ "-" }}</td>
            {% endfor %}
            
        {% if sportsgroupdependentlist[data.sgid]['trainersub'] is defined %}
            {% set trainer =sportsgroupdependentlist[data.sgid]['trainersub'] %}
        {% else %}
          {% set trainer ='' %}  
        {% endif %}
        <td>{% for TR in trainer %}                     
               {{TR.firstname }} {{TR.lastname }}<br>
            {% else %}
                {{ "-" }}</td>
            {% endfor %} 
       {# {% if sportsgroupdependentlist[data.trainerid]['sportgrouptrainer'] is defined %}
            {% set trainer =sportsgroupdependentlist[data.trainerid]['ssportgrouptrainer'] %}
        {% else %}
          {% set trainer ='' %}  
        {% endif %}
        <td>{% for TR in trainer if TR.trainerid != NULL %}                     
               {{TR.trainerid }}<br>
            {% else %}
                {{ "-" }}</td>
            {% endfor %}#} 
            
            {#<td bgcolor="#5fa8ec"></td>#}
       {% if sportsgroupdependentlist[data.sgid]['nonmemberstotal'] is defined %}
            {% set nonmember =sportsgroupdependentlist[data.sgid]['nonmemberstotal'] %}
        {% else %}
          {% set nonmember ='' %}  
        {% endif %}
        {% set foo =0 %}
        {% for NM in nonmember %}                     
               {% set foo = foo + 1 %}
            {% endfor %}
              <td>  {{ foo }}</td>

        {% if sportsgroupdependentlist[data.sgid]['nonmembers']['female'] is defined %}
            {% set nonmemberfemale =sportsgroupdependentlist[data.sgid]['nonmembers']['female'] %}
        {% else %}
          {% set nonmemberfemale ='-' %}  
        {% endif %}
    
              <td>  {{ nonmemberfemale }}</td>
              {#<td>{% for TR in nonmemberfemale %}                     
               {{TR}}
            {% else %}
                {{ "-" }}</td>
            {% endfor %}#} 

        {% if sportsgroupdependentlist[data.sgid]['nonmembers']['male'] is defined %}
            {% set nonmembermale =sportsgroupdependentlist[data.sgid]['nonmembers']['male'] %}
        {% else %}
            {% set nonmembermale ='-' %}  
        {% endif %}
        
              <td>  {{ nonmembermale}}</td>
        {#<td bgcolor="#A9D0F5"></td>  #}      
        <td>{{ data.capacity|striptags }}</td> 
        <td>{{ data.capacity - foo  }}</td>        
        
       {# <td bgcolor="#5fa8ec"></td>#}
        
        {% if sportsgroupdependentlist[data.sgid]['terminationdate'] is defined %}
        {% set terminationdate =sportsgroupdependentlist[data.sgid]['terminationdate'] %}
        {% else %}
          {% set terminationdate ='' %}  
        {% endif %}
        <td>{% for TD in terminationdate  %}
        <div class="{% if date(TD.terminationdate)|date("Y-m-d") < now|date_modify("+2 months")|date("Y-m-d") %}red {% endif %}
                   {% if (now|date("Y") == TD.terminationdate|date("Y") and now|date("Y-m-d") < TD.terminationdate|date("Y.m.d")) %}yellowbackground{% endif %}">
                    <strong>  {{  TD.terminationdate|date("d.m.Y")}}  </strong>   </div>
                  {% else %}
                         {{ "-" }}
                    {% endfor %}

        {% if sportsgroupdependentlist[data.sgid]['startdate'] is defined %}
            {% set startdate =sportsgroupdependentlist[data.sgid]['startdate'] %}
        {% else %}
          {% set startdate ='' %}  
        {% endif %}
        <td>{% for SD in startdate if date(SD.startdate) != NULL %}                     
               {{SD.startdate|date("d.m.Y") }}<br>
            {% else %}
                {{ "-" }}</td>
            {% endfor %} 
        
        {% if sportsgroupdependentlist[data.sgid]['groupnr'] is defined %}
            {% set groupnr =sportsgroupdependentlist[data.sgid]['groupnr'] %}
        {% else %}
          {% set groupnr ='' %}  
        {% endif %}
        <td>{% for GN in groupnr if GN.groupnr != NULL  %}                     
                <strong>{{GN.groupnr }}</strong><br>
            {% else %}
                {{ "-" }}</td>
            {% endfor %}  

        {% if sportsgroupdependentlist[data.sgid]['bssacertnr'] is defined %}
            {% set bssacertnr =sportsgroupdependentlist[data.sgid]['bssacertnr'] %}
        {% else %}
          {% set bssacertnr ='' %}  
        {% endif %}
        <td>{% for BC in bssacertnr if BC.bssacertnr != NULL %}                     
                 <strong>{{BC.bssacertnr }}</strong><br>
            {% else %}
                {{ "-" }}</td>
            {% endfor %} 
    
        <td>{{ data.sgid|striptags }}</td> 
        <td>{{ data.sgid|striptags }}</td> 
        <td>{{ data.sgid|striptags }}</td>
        <td>{{ data.sgid|striptags }}</td> 
        <td></td>
        
    {% endfor %}    
{% endblock %}
    
 {% block pagination %}
        <div class="row">
            <div class="col-md-12">
                <ul class="pagination">
                    
                <li {% if cletter == null %}class="active"{% endif %}><a href="{{ path(path, {'all': 'alle'}) }}">ALLE</a></li>   
                
                {% for letter in ['Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag', 'Sonntag'] %}
                    
                    {% if letter == cletter %}     
                    <li class="active"><a href="{{ path(path, {'letter': letter}) }}">{{ letter }}</a></li>      
                    {% else %}
                    <li><a href="{{ path(path, {'letter': letter}) }}">{{ letter }}</a></li>                    
                    {% endif %}
                    
                {% endfor %}
                
                <li class="active"><a href="{{ path(path, {'letter': cletter}) }}">{{ tabledata|length }} Sportgruppen wurden gefunden</a></li>
                </ul>         
            </div>           
        </div>        
    {% endblock %}